"use strict";(self.webpackChunkPF_angular_guisasola=self.webpackChunkPF_angular_guisasola||[]).push([[472],{7472:(Lt,J,i)=>{i.r(J),i.d(J,{CoursesModule:()=>It});var h=i(6814),K=i(6208),T=i(8034),Z=i(7501),d=i(6223),p=i(7700),j=i(9315),t=i(5879),x=i(8415),v=i(2296),M=i(2032),f=i(5683),R=i(8525),B=i(3680);function G(e,r){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.nameString," ")}}function z(e,r){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.name," ")}}let S=(()=>{class e{constructor(o,s,n,a){this.formBuilder=o,this.dialogRef=s,this.courseService=n,this.data=a,this.teachers=[],this.coursesNames=[],this.minStartDate=new Date,this.minEndDate=new Date,this.courseService.getCoursesNames().subscribe(m=>{m.sort((g,Y)=>g.nameString.localeCompare(Y.nameString)),this.coursesNames=m}),this.courseService.getTeachers().subscribe(m=>{m.sort((g,Y)=>g.name.localeCompare(Y.name)),this.teachers=m}),this.courseForm=this.initializeForm(),this.data&&(this.courseForm.patchValue(this.data),this.disableStarted(this.data),this.endDateControl.enable()),this.startDateControl.valueChanges.subscribe(m=>{if(m){this.endDateControl.enable();let g=new Date(this.startDateControl.value);this.minEndDate=new Date(g.getTime()+864e5)}else this.endDateControl.disable()})}initializeForm(){return this.formBuilder.group({id:[""],name:["",[d.kI.required]],startDate:["",[d.kI.required]],endDate:[{value:"",disabled:!0},[d.kI.required]],teacher:["",[d.kI.required]]})}ngOnInit(){(0,j.D)([this.courseService.getCoursesNames(),this.courseService.getTeachers()]).subscribe(([o,s])=>{if(o.sort((n,a)=>n.nameString.localeCompare(a.nameString)),s.sort((n,a)=>n.name.localeCompare(a.name)),this.coursesNames=o,this.teachers=s,this.initializeForm(),this.data){const n=this.coursesNames.find(m=>m.id===this.data?.name?.id),a=this.teachers.find(m=>m.id===this.data?.teacher?.id);n&&this.nameControl.setValue(n),a&&this.teacherControl.setValue(a)}})}onSubmit(){this.courseForm.enable();const o=this.courseForm.getRawValue();this.dialogRef.close(o)}get idControl(){return this.courseForm.controls.id}get nameControl(){return this.courseForm.controls.name}get startDateControl(){return this.courseForm.controls.startDate}get endDateControl(){return this.courseForm.controls.endDate}get teacherControl(){return this.courseForm.controls.teacher}get nameControlError(){return this.nameControl.hasError("required")?"Name is required":this.nameControl.hasError("pattern")?"Name must contain only letters":""}get startDateControlError(){return this.startDateControl.hasError("required")?"Start date is required":""}get endDateControlError(){return this.endDateControl.hasError("required")?"End date is required":""}get teacherControlError(){return this.teacherControl.hasError("required")?"A teacher is required":""}disableStarted(o){new Date(o.startDate)<this.minStartDate&&(this.startDateControl.disable(),this.nameControl.disable())}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(d.qu),t.Y36(p.so),t.Y36(x.N),t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-course-dialog"]],decls:47,vars:19,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"example-form"],[1,"invisible"],["matInput","",3,"formControl"],[1,"row"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"col"],["matInput","",3,"min","matDatepicker","formControl"],["matIconSuffix","",3,"for"],["picker",""],["picker1",""],["align","end"],["mat-stroked-button","","mat-dialog-close",""],["mat-flat-button","","color","accent",3,"disabled","click"],[3,"value"]],template:function(s,n){if(1&s&&(t.TgZ(0,"p",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"form",2)(4,"div",3)(5,"mat-form-field"),t._UZ(6,"input",4),t.qZA()(),t.TgZ(7,"div",5)(8,"mat-form-field")(9,"mat-label"),t._uU(10,"Course name"),t.qZA(),t.TgZ(11,"mat-select",6),t.YNc(12,G,2,2,"mat-option",7),t.qZA(),t.TgZ(13,"mat-error"),t._uU(14),t.qZA()()(),t.TgZ(15,"div",5)(16,"mat-form-field",8)(17,"mat-label"),t._uU(18,"Start date"),t.qZA(),t._UZ(19,"input",9),t.TgZ(20,"mat-error"),t._uU(21),t.qZA(),t._UZ(22,"mat-datepicker-toggle",10)(23,"mat-datepicker",null,11),t.qZA(),t.TgZ(25,"mat-form-field",8)(26,"mat-label"),t._uU(27,"End date"),t.qZA(),t._UZ(28,"input",9),t.TgZ(29,"mat-error"),t._uU(30),t.qZA(),t._UZ(31,"mat-datepicker-toggle",10)(32,"mat-datepicker",null,12),t.qZA()(),t.TgZ(34,"div",5)(35,"mat-form-field")(36,"mat-label"),t._uU(37,"Teacher"),t.qZA(),t.TgZ(38,"mat-select",6),t.YNc(39,z,2,2,"mat-option",7),t.qZA(),t.TgZ(40,"mat-error"),t._uU(41),t.qZA()()()()(),t.TgZ(42,"mat-dialog-actions",13)(43,"button",14),t._uU(44,"Cancel"),t.qZA(),t.TgZ(45,"button",15),t.NdJ("click",function(){return n.onSubmit()}),t._uU(46," Confirm "),t.qZA()()),2&s){const a=t.MAs(24),m=t.MAs(33);t.xp6(1),t.hij(" ",n.data?"Updating course":"Creating course","\n"),t.xp6(5),t.Q6J("formControl",n.idControl),t.xp6(5),t.Q6J("formControl",n.nameControl),t.xp6(1),t.Q6J("ngForOf",n.coursesNames),t.xp6(2),t.hij(" ",n.nameControlError," "),t.xp6(5),t.Q6J("min",n.minStartDate)("matDatepicker",a)("formControl",n.startDateControl),t.xp6(2),t.hij(" ",n.startDateControlError," "),t.xp6(1),t.Q6J("for",a),t.xp6(6),t.Q6J("min",n.minEndDate)("matDatepicker",m)("formControl",n.endDateControl),t.xp6(2),t.hij(" ",n.endDateControlError," "),t.xp6(1),t.Q6J("for",m),t.xp6(7),t.Q6J("formControl",n.teacherControl),t.xp6(1),t.Q6J("ngForOf",n.teachers),t.xp6(2),t.hij(" ",n.teacherControlError," "),t.xp6(4),t.Q6J("disabled",!n.courseForm.valid)}},dependencies:[h.sg,v.lW,d._Y,d.Fj,d.JJ,d.JL,d.oH,M.Nt,f.KE,f.hX,f.TO,f.R9,p.ZT,p.uh,p.xY,p.H8,R.gD,B.ey,T.Mq,T.hl,T.nW],styles:["mat-form-field[_ngcontent-%COMP%]{margin:.4em 0}mat-dialog-actions[_ngcontent-%COMP%]{padding:0 2em 2em 0}.invisible[_ngcontent-%COMP%]{display:none}"]})}return e})();var U=i(1630),$=i(3519),P=i.n($);let q=(()=>{class e{constructor(o){this.formBuilder=o,this.nameForm=this.formBuilder.group({name:["",[d.kI.required]]})}get nameControl(){return this.nameForm.controls.name}get nameControlError(){return this.nameControl.hasError("required")?"Name is required":this.nameControl.hasError("pattern")?"Name must contain only letters":""}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(d.qu))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-name-dialog"]],decls:14,vars:4,consts:[[1,"mat-typography"],[1,"example-form"],[1,"row"],["type","text","matInput","",3,"formControl"],["align","end"],["mat-stroked-button","","mat-dialog-close",""],["mat-flat-button","","color","accent",3,"disabled","mat-dialog-close"]],template:function(s,n){1&s&&(t.TgZ(0,"mat-dialog-content",0)(1,"form",1)(2,"div",2)(3,"mat-form-field")(4,"mat-label"),t._uU(5,"Name"),t.qZA(),t._UZ(6,"input",3),t.TgZ(7,"mat-error"),t._uU(8),t.qZA()()()()(),t.TgZ(9,"mat-dialog-actions",4)(10,"button",5),t._uU(11,"Cancel"),t.qZA(),t.TgZ(12,"button",6),t._uU(13," Confirm "),t.qZA()()),2&s&&(t.xp6(6),t.Q6J("formControl",n.nameControl),t.xp6(2),t.hij(" ",n.nameControlError," "),t.xp6(4),t.Q6J("disabled",!n.nameForm.valid)("mat-dialog-close",n.nameForm.value))},dependencies:[v.lW,d._Y,d.Fj,d.JJ,d.JL,d.oH,M.Nt,f.KE,f.hX,f.TO,p.ZT,p.xY,p.H8],encapsulation:2})}return e})();var l=i(4221);const c=(0,l.R7)({source:"Course",events:{"Load Courses":(0,l.uZ)(),"Load Courses Success":(0,l.Ky)(),"Load Courses Failure":(0,l.Ky)(),"Create Course":(0,l.Ky)(),"Create Course Failure":(0,l.Ky)(),"Update Course":(0,l.Ky)(),"Update Course Failure":(0,l.Ky)(),"Delete Course":(0,l.Ky)(),"Delete Course Failure":(0,l.Ky)()}}),N="course",X=(0,l.Lq)({isLoading:!1,courses:[],error:null},(0,l.on)(c.loadCourses,e=>({...e,isLoading:!0})),(0,l.on)(c.loadCoursesSuccess,(e,{data:r})=>({...e,isLoading:!1,courses:r})),(0,l.on)(c.loadCoursesFailure,(e,{error:r})=>({...e,isLoading:!1,error:r})),(0,l.on)(c.createCourse,e=>({...e,isLoading:!0})),(0,l.on)(c.createCourseFailure,(e,{error:r})=>({...e,isLoading:!1,error:r})),(0,l.on)(c.updateCourse,e=>({...e,isLoading:!0})),(0,l.on)(c.updateCourseFailure,(e,{error:r})=>({...e,isLoading:!1,error:r})),(0,l.on)(c.deleteCourse,e=>({...e,isLoading:!0})),(0,l.on)(c.deleteCourseFailure,(e,{error:r})=>({...e,isLoading:!1,error:r}))),V=(0,l.Tz)({name:N,reducer:X}),w=(0,l.ZF)(N),tt=(0,l.P1)(w,e=>e.courses),et=(0,l.P1)(w,e=>e.isLoading);var Q=i(4590),F=i(617),O=i(5940),I=i(1476),u=i(5313),ot=i(1064),L=i(3566),k=i(2596);const nt=["coursesSort"];function st(e,r){1&e&&(t.TgZ(0,"th",14),t._uU(1," Name "),t.qZA())}function at(e,r){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",null==o.name?null:o.name.nameString," ")}}function rt(e,r){1&e&&(t.TgZ(0,"th",14),t._uU(1," Teacher "),t.qZA())}function it(e,r){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",o.teacher.name," ")}}function lt(e,r){1&e&&(t.TgZ(0,"th",14),t._uU(1," Start date "),t.qZA())}function ct(e,r){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.startDate,"yyyy/MM/dd")," ")}}function ut(e,r){1&e&&(t.TgZ(0,"th",14),t._uU(1," End date "),t.qZA())}function mt(e,r){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.endDate,"yyyy/MM/dd")," ")}}function dt(e,r){1&e&&(t.TgZ(0,"th",16),t._uU(1," Actions "),t.qZA())}function pt(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-icon",20),t.NdJ("click",function(){t.CHM(o);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.updateCourse.emit(n))}),t._uU(1," edit "),t.qZA()}}function Ct(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-icon",21),t.NdJ("click",function(){t.CHM(o);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.deleteCourse.emit(n.id))}),t._uU(1," delete "),t.qZA()}}function ht(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"td",15)(1,"mat-icon",17),t.NdJ("click",function(){const a=t.CHM(o).$implicit,m=t.oxw();return t.KtG(m.goToDetail(a.id))}),t._uU(2," visibility "),t.qZA(),t.YNc(3,pt,2,0,"mat-icon",18),t.YNc(4,Ct,2,0,"mat-icon",19),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.Q6J("ngIf",o.isAdmin),t.xp6(1),t.Q6J("ngIf",o.isAdmin)}}function ft(e,r){1&e&&t._UZ(0,"tr",22)}function gt(e,r){1&e&&t._UZ(0,"tr",23)}const _t=function(){return[5,10,20]};let Tt=(()=>{class e{constructor(o,s){this.router=o,this.store=s,this.isAdmin=!1,this.deleteCourse=new t.vpe,this.updateCourse=new t.vpe,this.displayedColumns=["name","teacher","start","end","actions"],this.dataSource=new u.by,this.store.select(Q.u).subscribe(n=>this.isAdmin="ADMINISTRATOR"===n?.role)}ngAfterViewInit(){this.initialize()}ngOnChanges(){this.initialize()}initialize(){this.dataSource=new u.by(this.table),this.dataSource.paginator=this.paginator,this.dataSource.sortingDataAccessor=(o,s)=>{switch(s){case"name":return o.name?.nameString||"";case"teacher":return o.teacher?.name||"";case"start":return o.startDate?.toString()||0;case"end":return o.endDate?.toString()||0;default:return""}},this.dataSource.sort=this.coursesSort}goToDetail(o){this.router.navigate(["dashboard","courses","detail",o])}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(Z.F0),t.Y36(l.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-courses-table"]],viewQuery:function(s,n){if(1&s&&(t.Gf(I.NW,5),t.Gf(nt,5)),2&s){let a;t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.coursesSort=a.first)}},inputs:{table:"table"},outputs:{deleteCourse:"deleteCourse",updateCourse:"updateCourse"},features:[t.TTD],decls:21,vars:5,consts:[["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["coursesSort","matSort"],["matColumnDef","name"],["appFontSize","50px","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","teacher"],["matColumnDef","start"],["matColumnDef","end"],["matColumnDef","actions"],["appFontSize","","mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["color","accent",3,"pageSizeOptions"],["paginator",""],["appFontSize","50px","mat-header-cell","","mat-sort-header",""],["mat-cell",""],["appFontSize","","mat-header-cell",""],["matTooltip","View course's detail",3,"click"],["matTooltip","Update course's details",3,"click",4,"ngIf"],["matTooltip","Delete course",3,"click",4,"ngIf"],["matTooltip","Update course's details",3,"click"],["matTooltip","Delete course",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(s,n){1&s&&(t.TgZ(0,"table",0,1),t.ynx(2,2),t.YNc(3,st,2,0,"th",3),t.YNc(4,at,2,1,"td",4),t.BQk(),t.ynx(5,5),t.YNc(6,rt,2,0,"th",3),t.YNc(7,it,2,1,"td",4),t.BQk(),t.ynx(8,6),t.YNc(9,lt,2,0,"th",3),t.YNc(10,ct,3,4,"td",4),t.BQk(),t.ynx(11,7),t.YNc(12,ut,2,0,"th",3),t.YNc(13,mt,3,4,"td",4),t.BQk(),t.ynx(14,8),t.YNc(15,dt,2,0,"th",9),t.YNc(16,ht,5,2,"td",4),t.BQk(),t.YNc(17,ft,1,0,"tr",10),t.YNc(18,gt,1,0,"tr",11),t.qZA(),t._UZ(19,"mat-paginator",12,13)),2&s&&(t.Q6J("dataSource",n.dataSource),t.xp6(17),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,_t)))},dependencies:[h.O5,F.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,ot.h,I.NW,L.YE,L.nU,k.gM,h.uU],styles:["mat-icon[_ngcontent-%COMP%]{margin:.2em}"]})}return e})();function Zt(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"div")(1,"button",4),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.onAddTeacher())}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA(),t._uU(4," Add teacher "),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.onAddName())}),t.TgZ(6,"mat-icon"),t._uU(7,"add"),t.qZA(),t._uU(8," Add course name "),t.qZA(),t.TgZ(9,"button",4),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.onAddCourse())}),t.TgZ(10,"mat-icon"),t._uU(11,"add"),t.qZA(),t._uU(12," New course "),t.qZA()()}}function xt(e,r){1&e&&(t.TgZ(0,"div",5),t._UZ(1,"mat-spinner",6),t.qZA())}function vt(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"app-courses-table",7),t.NdJ("deleteCourse",function(n){t.CHM(o);const a=t.oxw();return t.KtG(a.onDeleteCourse(n))})("updateCourse",function(n){t.CHM(o);const a=t.oxw();return t.KtG(a.onUpdateCourse(n))}),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("table",o.courses)}}let Dt=(()=>{class e{constructor(o,s,n){this.dialog=o,this.courseService=s,this.store=n,this.courses=[],this.isAdmin=!1,this.isLoading=!0,this.store.select(Q.u).subscribe(a=>this.isAdmin="ADMINISTRATOR"===a?.role),this.store.dispatch(c.loadCourses()),this.store.select(et).subscribe(a=>this.isLoading=a),this.store.select(tt).subscribe(a=>this.courses=a)}onAddTeacher(){this.dialog.open(q).afterClosed().subscribe({next:o=>{o&&this.courseService.addTeacher({id:(0,U.x0)(5),name:o.name}).subscribe()}})}onAddName(){this.dialog.open(q).afterClosed().subscribe({next:o=>{o&&this.courseService.addCourseName({id:(0,U.x0)(5),nameString:o.name}).subscribe()}})}onAddCourse(){this.dialog.open(S).afterClosed().subscribe({next:o=>{if(o){let s={id:(0,U.x0)(5),name:o.name,startDate:o.startDate,endDate:o.endDate,teacher:o.teacher};this.store.dispatch(c.createCourse({payload:s}))}}})}onUpdateCourse(o){this.dialog.open(S,{data:o}).beforeClosed().subscribe({next:s=>{s&&this.store.dispatch(c.updateCourse({id:o.id,payload:s}))}})}onDeleteCourse(o){P().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",heightAuto:!1}).then(s=>{s.isConfirmed&&this.store.dispatch(c.deleteCourse({id:o}))})}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(p.uw),t.Y36(x.N),t.Y36(l.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-courses"]],decls:7,vars:3,consts:[[1,"container"],[4,"ngIf"],["class","loading",4,"ngIf","ngIfElse"],["table",""],["mat-flat-button","","color","accent",3,"click"],[1,"loading"],["color","accent"],[3,"table","deleteCourse","updateCourse"]],template:function(s,n){if(1&s&&(t.TgZ(0,"div",0)(1,"p"),t._uU(2,"COURSES"),t.qZA(),t.YNc(3,Zt,13,0,"div",1),t.qZA(),t.YNc(4,xt,2,0,"div",2),t.YNc(5,vt,1,1,"ng-template",null,3,t.W1O)),2&s){const a=t.MAs(6);t.xp6(3),t.Q6J("ngIf",n.isAdmin),t.xp6(1),t.Q6J("ngIf",n.isLoading)("ngIfElse",a)}},dependencies:[h.O5,v.lW,F.Hw,O.Ou,Tt],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:1em 0}button[_ngcontent-%COMP%]{margin-right:1.5em;margin-bottom:.5em}p[_ngcontent-%COMP%]{font-size:2.5em;text-shadow:5px -5px .3em black,5px 5px .3em black,-5px 5px .3em black,-5px -5px .3em black}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;height:100%}"]})}return e})();var bt=i(5937),E=i(9591),H=i(8571),At=i(5311),_=i(5195),yt=i(6385),St=i(9638);function Ut(e,r){1&e&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner",3),t.qZA())}function Nt(e,r){1&e&&(t.TgZ(0,"th",16),t._uU(1,"Student"),t.qZA())}function Ft(e,r){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.ALo(2,"fullname"),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.student.name,o.student.surname)," ")}}function Et(e,r){1&e&&(t.TgZ(0,"th",16),t._uU(1," Actions "),t.qZA())}function Yt(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"td",17)(1,"mat-icon",18),t.NdJ("click",function(){const a=t.CHM(o).$implicit,m=t.oxw(2);return t.KtG(m.sendEmail(a.studentId))}),t._uU(2," email "),t.qZA(),t.TgZ(3,"mat-icon",19),t.NdJ("click",function(){const a=t.CHM(o).$implicit,m=t.oxw(2);return t.KtG(m.deleteEnrollment(a.id))}),t._uU(4," delete "),t.qZA()()}}function Jt(e,r){1&e&&t._UZ(0,"tr",20)}function Mt(e,r){1&e&&t._UZ(0,"tr",21)}function qt(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"mat-card",4)(1,"mat-card-header")(2,"div")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.qZA()(),t.TgZ(7,"div",5)(8,"mat-card-subtitle"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"mat-card-subtitle"),t._uU(12),t.ALo(13,"date"),t.qZA()(),t.TgZ(14,"div",6)(15,"button",7),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.updateCourse())}),t._uU(16," Edit course "),t.qZA(),t.TgZ(17,"button",7),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.enrollStudent())}),t._uU(18," Enroll "),t.qZA()()(),t._UZ(19,"mat-divider",8),t.TgZ(20,"mat-card-content")(21,"table",9),t.ynx(22,10),t.YNc(23,Nt,2,0,"th",11),t.YNc(24,Ft,3,4,"td",12),t.BQk(),t.ynx(25,13),t.YNc(26,Et,2,0,"th",11),t.YNc(27,Yt,5,0,"td",12),t.BQk(),t.YNc(28,Jt,1,0,"tr",14),t.YNc(29,Mt,1,0,"tr",15),t.qZA()()()}if(2&e){const o=t.oxw();t.xp6(4),t.Oqu(null==o.course||null==o.course.name?null:o.course.name.nameString),t.xp6(2),t.Oqu(null==o.course||null==o.course.teacher?null:o.course.teacher.name),t.xp6(3),t.hij("Starts on: ",t.xi3(10,7,null==o.course?null:o.course.startDate,"yyyy/MM/dd"),""),t.xp6(3),t.hij("Ends on: ",t.xi3(13,10,null==o.course?null:o.course.endDate,"yyyy/MM/dd"),""),t.xp6(9),t.Q6J("dataSource",o.students),t.xp6(7),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns)}}const wt=[{path:"",component:Dt},{path:"detail/:id",component:(()=>{class e{constructor(o,s,n,a,m){this.activatedRoute=o,this.courseService=s,this.studentService=n,this.dialog=a,this.store=m,this.displayedColumns=["student","actions"],this.dataSource=[],this.isLoading=!0,this.id=this.activatedRoute.snapshot.params.id,this.courseService.getById(this.id).subscribe(g=>this.course=g[0]),this.getEnrollments()}getEnrollments(){this.store.dispatch(E.c.loadEnrollmentsByCourse({id:this.id})),this.students=this.store.select(H.YD),this.store.select(H.B1).subscribe(o=>this.isLoading=o)}enrollStudent(){this.dialog.open(bt.L,{data:{student:null,course:this.course}}).afterClosed().subscribe({next:()=>{this.store.dispatch(E.c.loadEnrollmentsByCourse({id:this.id}))}})}updateCourse(){this.dialog.open(S,{data:this.course}).afterClosed().subscribe({next:o=>{o&&this.courseService.updateCourse(this.id,o).subscribe(()=>{this.courseService.getById(this.id).subscribe(s=>this.course=s[0])})}})}sendEmail(o){this.studentService.sendEmail(o)}deleteEnrollment(o){this.store.dispatch(E.c.deleteEnrollment({id:o,source:"course",sourceId:this.id})),this.getEnrollments()}static#t=this.\u0275fac=function(s){return new(s||e)(t.Y36(Z.gz),t.Y36(x.N),t.Y36(At.V),t.Y36(p.uw),t.Y36(l.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-course-detail"]],decls:3,vars:2,consts:[["class","loading",4,"ngIf","ngIfElse"],["detail",""],[1,"loading"],["color","accent"],[1,"example-card"],[1,"dates"],[1,"buttons"],["mat-flat-button","","color","accent",3,"click"],[2,"margin-top","1em"],["mat-table","",3,"dataSource"],["matColumnDef","student"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["matTooltip","Send email","matTooltipPosition","after",3,"click"],["matTooltip","Delete enrollment","matTooltipPosition","after",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(s,n){if(1&s&&(t.YNc(0,Ut,2,0,"div",0),t.YNc(1,qt,30,13,"ng-template",null,1,t.W1O)),2&s){const a=t.MAs(2);t.Q6J("ngIf",n.isLoading)("ngIfElse",a)}},dependencies:[h.O5,_.a8,_.dn,_.dk,_.$j,_.n5,v.lW,F.Hw,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,k.gM,yt.d,O.Ou,h.uU,St.J],styles:["mat-card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.dates[_ngcontent-%COMP%]{margin-left:5%}.buttons[_ngcontent-%COMP%]{position:absolute;right:3em;display:flex;flex-direction:column}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;height:100%}"]})}return e})()}];let Qt=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild(wt),Z.Bz]})}return e})();var C=i(5154),D=i(6328),b=i(7398),A=i(6306),y=i(2096);let Ot=(()=>{class e{constructor(o,s){this.actions$=o,this.service=s,this.loadCourses$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(c.loadCourses),(0,D.b)(()=>this.service.getCourses().pipe((0,b.U)(n=>c.loadCoursesSuccess({data:n})),(0,A.K)(n=>(0,y.of)(c.loadCoursesFailure({error:n}))))))),this.createCourse$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(c.createCourse),(0,D.b)(n=>this.service.createCourse(n.payload).pipe((0,b.U)(()=>c.loadCourses()),(0,A.K)(a=>(0,y.of)(c.createCourseFailure({error:a}))))))),this.updateCourse$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(c.updateCourse),(0,D.b)(n=>this.service.updateCourse(n.id,n.payload).pipe((0,b.U)(()=>c.loadCourses()),(0,A.K)(a=>(0,y.of)(c.updateCourseFailure({error:a}))))))),this.deleteCourse$=(0,C.GW)(()=>this.actions$.pipe((0,C.l4)(c.deleteCourse),(0,D.b)(n=>this.service.deleteCourse(n.id).pipe((0,b.U)(()=>c.loadCourses()),(0,A.K)(a=>(0,y.of)(c.deleteCourseFailure({error:a})))))))}static#t=this.\u0275fac=function(s){return new(s||e)(t.LFG(C.eX),t.LFG(x.N))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})(),It=(()=>{class e{static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[h.ez,K.m,T.FA,Qt,l.Aw.forFeature(N,V.reducer),C.sQ.forFeature([Ot])]})}return e})()}}]);